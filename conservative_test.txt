2025-07-01 12:19:11.174 mjpython[81229:10887794] WARNING: Secure coding is automatically enabled for restorable state! However, not on all supported macOS versions of this application. Opt-in to secure coding explicitly by implementing NSApplicationDelegate.applicationSupportsSecureRestorableState:.
<frozen importlib._bootstrap>:241: RuntimeWarning: to-Python converter for boost::shared_ptr<tsid::math::ConstraintBase> already registered; second conversion method ignored.
Initializing walking simulation...
WARNING: Could not load 'standing' configuration from SRDF. Creating standing configuration.
Available frames in robot model:
  0: universe
  1: root_joint
  2: torso
  3: head_yaw
  4: sts3250_6
  5: head_pitch
  6: camera_enclosure
  7: left_hip_yaw
  8: yaw_adapter_2
  9: left_hip_roll
  10: bearing
  11: left_hip_pitch
  12: sts3250_2
  13: left_knee
  14: knee_ankle_rotor_case_2
  15: left_ankle_pitch
  16: sts3250_3
  17: left_ankle_roll
  18: foot_2
  19: left_sole_joint_fixed
  20: foot_2_sole
  21: left_shoulder_pitch
  22: shoulder_rightangle
  23: left_shoulder_roll
  24: bicep
  25: left_elbow
  26: forearm
  27: right_hip_yaw
  28: yaw_adapter
  29: right_hip_roll
  30: pitch_roll_housing
  31: right_hip_pitch
  32: knee_housing
  33: right_knee
  34: knee_ankle_rotor_case
  35: right_ankle_pitch
  36: sts3250
  37: right_ankle_roll
  38: foot
  39: right_sole_joint_fixed
  40: foot_sole
  41: right_shoulder_pitch
  42: shoulder_rightangle_2
  43: right_shoulder_roll
  44: sts3250_4
  45: right_elbow
  46: sts3250_5
Looking for frames: foot_sole, foot_2_sole
Left foot position:    R =
  4.8648e-06            1 -6.18711e-06
   -0.995005  5.45814e-06    0.0998271
   0.0998271  5.67057e-06     0.995005
  p = 0.0423607 0.0371452 0.0685631

DEBUG: gain_vector size: 20
DEBUG: gain_vector: [0.5 0.5 0.2 0.2 0.2 0.1 0.1 0.2 0.2 0.2 0.2 0.2 0.2 0.1 0.1 0.2 0.2 0.2
 0.1 0.1]
DEBUG: robot.na (number of actuated joints): 20
Generating walking path...
Current left foot: [0.04236069 0.03714515 0.06856314]
Current right foot: [-0.04236009  0.0495948   0.06815774]
Step 0: Right foot from [-0.04236009  0.0495948 ] to [ 0.0200003  -0.00663002]
Step 1: Left foot from [0.04236069 0.03714515] to [0.0400003  0.09336998]
Generated footsteps:
  0: Left foot at (0.042, 0.037)
  1: Right foot at (-0.042, 0.050)
  2: Right foot at (0.020, -0.007)
  3: Left foot at (0.040, 0.093)
Generated 2 footstep trajectories
Generated 4 footsteps
First 10 DCM trajectory points (first step):
[0.02186714 0.05596837]
[0.02185747 0.05597725]
[0.02184781 0.05598613]
[0.02183814 0.055995  ]
[0.02182847 0.05600388]
[0.02181881 0.05601276]
[0.02180914 0.05602164]
[0.02179947 0.05603052]
[0.02178981 0.0560394 ]
[0.02178014 0.05604828]
Generated DCM trajectory with 4 endpoints
Generated ZMP trajectory
Loading MuJoCo model...
üîß BEFORE HEIGHT FIX:
   Current base height q[2]: 0.399961
   Current foot heights: L=0.731929, R=0.731928
üîß AFTER HEIGHT FIX:
   Target CoM height: 0.4
   Set base height to: -0.537000
   Expected CoM offset: 0.937m above base
   Expected final CoM: 0.400000m
============================================================
üîç DETAILED INITIALIZATION DEBUG
============================================================
Initial CoM: [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
Left foot: [ 0.0421462  -0.08918553 -0.19700437]
Right foot: [-0.04275952 -0.08873965 -0.19700873]
Feet center: [-0.00030666 -0.08896259 -0.19700655]
Initial q[0:3]: [ 2.77350442e-07 -4.45858529e-02 -5.37000000e-01]
Feet on ground: Left=-0.197004, Right=-0.197009
Configuration z0: 0.4
PROBLEM: Computed CoM height is -0.438711, should be ~0.4
============================================================
Starting MuJoCo simulation...
PHASE 1: Standing phase (2 seconds)...

üîç STEP 0 DEBUG:
   com_0 (original): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   com_ref (ramped): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   Ramp progress: 0.000 (0.000s / 2.0s)
   Height ramp: -0.438711 ‚Üí -0.438711 ‚Üí 0.400000
   QP status: 0
   Computed accelerations (first 5): [ -0.2095059    0.56498305   0.93958112 170.4907669   -3.46704633]
   Current velocities (first 5): [ 1.16664446e-19 -1.47877839e-18 -1.96200000e-02  1.79986883e-17
  1.09095272e-18]
   Current positions (first 5): [ 2.77350442e-07 -4.45858529e-02 -5.37000000e-01  1.00000000e+00
  1.80319823e-20]
üîç CONTROL MAPPING DEBUG (call #1):
   Input q_tsid shape: (27,), range: [-0.537, 1.000]
   Input v_tsid shape: (26,), range: [-0.522, 0.898]
   Input dv_tsid shape: (26,), range: [-261.218, 448.911]
   Joint positions (7-12): [-3.27906503e-06  1.09843476e-04  1.69033198e-05 -1.51642388e-05
  8.71626715e-04 -2.41275818e-04]
   Joint velocities (7-12): [ 0.10984348  0.01690332 -0.01516424  0.87162672 -0.24127582  0.89782237]
   Joint accelerations (7-12): [  54.92173812    8.45165988   -7.5821194   435.81335772 -120.63790904
  448.91118261]
   Computed torques (first 5): [-0.16395325  0.5         0.5        -0.5         0.5       ]
   Max torque magnitude: 0.500 Nm
   Control commands: [-0.16395325  0.5         0.5        -0.5         0.5       ] (first 5 actuators)
   Max control command: 0.5
   Result CoM: [-7.90144289e-05 -9.66503161e-02 -4.46736302e-01]
   CoM height change: -0.008026
   ‚ö†Ô∏è  WARNING: Large base position change: 0.111101
   ---
Standing phase: 0/1500, CoM: [-7.90144289e-05 -9.66503161e-02 -4.46736302e-01]

üîç STEP 1 DEBUG:
   com_0 (original): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   com_ref (ramped): [-4.28877205e-04 -9.64507243e-02 -4.37871866e-01]
   Ramp progress: 0.001 (0.002s / 2.0s)
   Height ramp: -0.438711 ‚Üí -0.437872 ‚Üí 0.400000
   QP status: 0
   Computed accelerations (first 5): [ -0.25688942   0.63313975   1.20062121 165.15458997  -3.34133251]
   Current velocities (first 5): [-0.00041901  0.00112997 -0.01774084  0.34098153 -0.00693409]
   Current positions (first 5): [-1.41522232e-07 -4.45869892e-02 -5.36962639e-01  9.99999985e-01
  8.45129174e-06]
üîç CONTROL MAPPING DEBUG (call #2):
   Input q_tsid shape: (27,), range: [-0.537, 1.000]
   Input v_tsid shape: (26,), range: [-1.036, 1.760]
   Input dv_tsid shape: (26,), range: [-256.570, 431.123]
   Joint positions (7-12): [-1.31576709e-05  4.41037972e-04  6.94748879e-05 -6.00866111e-05
  3.45857920e-03 -9.58971387e-04]
   Joint velocities (7-12): [ 0.22135102  0.03566825 -0.02975813  1.71532577 -0.47641975  1.76006799]
   Joint accelerations (7-12): [  55.7537716     9.38246429   -7.29694737  421.84952924 -117.57196615
  431.12281366]
   Computed torques (first 5): [-0.16602379  0.5         0.5        -0.5         0.5       ]
   Max torque magnitude: 0.500 Nm
   Control commands: [-0.16602379  0.5         0.5        -0.5         0.5       ] (first 5 actuators)
   Max control command: 0.5
   Result CoM: [-7.90141451e-05 -9.66503195e-02 -4.46716687e-01]
   CoM height change: -0.008845
   ‚ö†Ô∏è  WARNING: Large base position change: 0.111813
   ---

üîç STEP 2 DEBUG:
   com_0 (original): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   com_ref (ramped): [-4.28877205e-04 -9.64507243e-02 -4.37033156e-01]
   Ramp progress: 0.002 (0.004s / 2.0s)
   Height ramp: -0.438711 ‚Üí -0.437033 ‚Üí 0.400000
   QP status: 0
   Computed accelerations (first 5): [ -0.36840804   0.61777069   1.51211165 158.27361729  -3.03948457]
   Current velocities (first 5): [-0.00093279  0.00239625 -0.0153396   0.67129071 -0.01361676]
   Current positions (first 5): [-1.49260244e-06 -4.45905435e-02 -5.36929562e-01  9.99999770e-01
  3.47331035e-05]
üîç CONTROL MAPPING DEBUG (call #3):
   Input q_tsid shape: (27,), range: [-0.537, 1.000]
   Input v_tsid shape: (26,), range: [-1.536, 2.589]
   Input dv_tsid shape: (26,), range: [-250.058, 414.657]
   Joint positions (7-12): [-2.97739118e-05  9.96456809e-04  1.63842792e-04 -1.32957978e-04
  7.69323232e-03 -2.13023440e-03]
   Joint velocities (7-12): [ 0.33406782  0.05869966 -0.04311323  2.51932734 -0.69484327  2.58938141]
   Joint accelerations (7-12): [  56.35839893   11.51570354   -6.67754991  402.00078183 -109.21175865
  414.65670695]
   Computed torques (first 5): [-0.17085796  0.5         0.5        -0.5         0.5       ]
   Max torque magnitude: 0.500 Nm
   Control commands: [-0.17085796  0.5         0.5        -0.5         0.5       ] (first 5 actuators)
   Max control command: 0.5
   Result CoM: [-7.90123564e-05 -9.66503093e-02 -4.46736355e-01]
   CoM height change: -0.009703
   ‚ö†Ô∏è  WARNING: Large base position change: 0.112529
   ---

üîç STEP 3 DEBUG:
   com_0 (original): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   com_ref (ramped): [-4.28877205e-04 -9.64507243e-02 -4.36194445e-01]
   Ramp progress: 0.003 (0.006s / 2.0s)
   Height ramp: -0.438711 ‚Üí -0.436194 ‚Üí 0.400000
   QP status: 0
   Computed accelerations (first 5): [ -0.5451647    0.51460224   1.8817519  149.79072809  -2.5923138 ]
   Current velocities (first 5): [-0.00166961  0.00363179 -0.01231537  0.98783795 -0.01969573]
   Current positions (first 5): [-4.09307269e-06 -4.45966322e-02 -5.36901920e-01  9.99998862e-01
  8.18985787e-05]
   Control commands: [-0.17789839  0.5         0.5        -0.5         0.5       ] (first 5 actuators)
   Max control command: 0.5
   Result CoM: [-7.90069263e-05 -9.66502465e-02 -4.46795362e-01]
   CoM height change: -0.010601
   ‚ö†Ô∏è  WARNING: Large CoM height deviation!
   ‚ö†Ô∏è  WARNING: Large base position change: 0.113252
   ---

üîç STEP 4 DEBUG:
   com_0 (original): [-4.28877205e-04 -9.64507243e-02 -4.38710577e-01]
   com_ref (ramped): [-4.28877205e-04 -9.64507243e-02 -4.35355735e-01]
   Ramp progress: 0.004 (0.008s / 2.0s)
   Height ramp: -0.438711 ‚Üí -0.435356 ‚Üí 0.400000
   QP status: 0
   Computed accelerations (first 5): [ -0.78840199   0.31662525   2.31962451 139.63229935  -2.03800938]
   Current velocities (first 5): [-0.00275994  0.00466099 -0.00855187  1.2874194  -0.02488035]
   Current positions (first 5): [-8.51890490e-06 -4.46050126e-02 -5.36881087e-01  9.99996492e-01
  1.55434088e-04]
   Control commands: [-0.18628599  0.5         0.5        -0.47136845  0.5       ] (first 5 actuators)
   Max control command: 0.5
   Result CoM: [-7.89949076e-05 -9.66500946e-02 -4.46893760e-01]
   CoM height change: -0.011538
   ‚ö†Ô∏è  WARNING: Large CoM height deviation!
   ‚ö†Ô∏è  WARNING: Large base position change: 0.113982
   ---
Standing phase: 500/1500, CoM: [-0.26469597 -0.16764457  0.29135298]
Standing phase: 1000/1500, CoM: [-0.01577876 -0.02933607  0.25304728]
PHASE 2: Starting walking phase...
Starting walking controller...
Walking started with 2 steps
DEBUG: current_step=0, time_step=0
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][0]
DEBUG: CoM reference: [0.17616176 0.12540146 0.4       ]
DEBUG: Actual CoM: [0.17816176 0.12740146 0.22371542]
Foot position too far (0.160m), limiting movement
DEBUG: current_step=0, time_step=1
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][1]
DEBUG: CoM reference: [0.17716176 0.12498083 0.4       ]
DEBUG: Actual CoM: [0.17932215 0.12698083 0.22244154]
Foot position too far (0.159m), limiting movement
DEBUG: current_step=0, time_step=2
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][2]
DEBUG: CoM reference: [0.17742374 0.12493648 0.4       ]
DEBUG: Actual CoM: [0.17942374 0.12693648 0.22228512]
Foot position too far (0.159m), limiting movement
DEBUG: current_step=0, time_step=3
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][3]
DEBUG: CoM reference: [0.17750714 0.12489002 0.4       ]
DEBUG: Actual CoM: [0.17950714 0.12689002 0.22209496]
Foot position too far (0.159m), limiting movement
DEBUG: current_step=0, time_step=4
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][4]
DEBUG: CoM reference: [0.17758982 0.1248403  0.4       ]
DEBUG: Actual CoM: [0.17958982 0.1268403  0.22187709]
Foot position too far (0.159m), limiting movement
DEBUG: current_step=0, time_step=5
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][5]
DEBUG: CoM reference: [0.17767156 0.12478741 0.4       ]
DEBUG: Actual CoM: [0.17967156 0.12678741 0.22163244]
Foot position too far (0.159m), limiting movement
DEBUG: current_step=0, time_step=6
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][6]
DEBUG: CoM reference: [0.1777521  0.12473145 0.4       ]
DEBUG: Actual CoM: [0.1797521  0.12673145 0.22136192]
Foot position too far (0.158m), limiting movement
DEBUG: current_step=0, time_step=7
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][7]
DEBUG: CoM reference: [0.17783122 0.12467246 0.4       ]
DEBUG: Actual CoM: [0.17983122 0.12667246 0.22106627]
Foot position too far (0.158m), limiting movement
DEBUG: current_step=0, time_step=8
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][8]
DEBUG: CoM reference: [0.17790876 0.12461054 0.4       ]
DEBUG: Actual CoM: [0.17990876 0.12661054 0.22074634]
Foot position too far (0.158m), limiting movement
DEBUG: current_step=0, time_step=9
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][9]
DEBUG: CoM reference: [0.17798457 0.12454578 0.4       ]
DEBUG: Actual CoM: [0.17998457 0.12654578 0.22040296]
Foot position too far (0.158m), limiting movement
DEBUG: current_step=0, time_step=10
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][10]
DEBUG: CoM reference: [0.17805848 0.12447825 0.4       ]
DEBUG: Actual CoM: [0.18005848 0.12647825 0.22003678]
Foot position too far (0.157m), limiting movement
DEBUG: current_step=0, time_step=11
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][11]
DEBUG: CoM reference: [0.17813035 0.12440797 0.4       ]
DEBUG: Actual CoM: [0.18013035 0.12640797 0.2196484 ]
Foot position too far (0.157m), limiting movement
DEBUG: current_step=0, time_step=12
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][12]
DEBUG: CoM reference: [0.1782002  0.12433495 0.4       ]
DEBUG: Actual CoM: [0.1802002  0.12633495 0.21923862]
Foot position too far (0.157m), limiting movement
DEBUG: current_step=0, time_step=13
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][13]
DEBUG: CoM reference: [0.1782682  0.12425914 0.4       ]
DEBUG: Actual CoM: [0.1802682  0.12625914 0.2188086 ]
Foot position too far (0.156m), limiting movement
DEBUG: current_step=0, time_step=14
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][14]
DEBUG: CoM reference: [0.17833447 0.1241805  0.4       ]
DEBUG: Actual CoM: [0.18033447 0.1261805  0.21835931]
Foot position too far (0.156m), limiting movement
DEBUG: current_step=0, time_step=15
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][15]
DEBUG: CoM reference: [0.17839902 0.12409906 0.4       ]
DEBUG: Actual CoM: [0.18039902 0.12609906 0.21789146]
Foot position too far (0.156m), limiting movement
DEBUG: current_step=0, time_step=16
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][16]
DEBUG: CoM reference: [0.17846176 0.12401485 0.4       ]
DEBUG: Actual CoM: [0.18046176 0.12601485 0.2174055 ]
Foot position too far (0.155m), limiting movement
DEBUG: current_step=0, time_step=17
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][17]
DEBUG: CoM reference: [0.1785227  0.12392799 0.4       ]
DEBUG: Actual CoM: [0.1805227  0.12592799 0.21690198]
Foot position too far (0.155m), limiting movement
DEBUG: current_step=0, time_step=18
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][18]
DEBUG: CoM reference: [0.17858195 0.12383874 0.4       ]
DEBUG: Actual CoM: [0.18058195 0.12583874 0.21638161]
Foot position too far (0.154m), limiting movement
DEBUG: current_step=0, time_step=19
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][19]
DEBUG: CoM reference: [0.17863961 0.12374736 0.4       ]
DEBUG: Actual CoM: [0.18063961 0.12574736 0.21584513]
Foot position too far (0.154m), limiting movement
DEBUG: current_step=0, time_step=20
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][20]
DEBUG: CoM reference: [0.17869581 0.12365408 0.4       ]
DEBUG: Actual CoM: [0.18069581 0.12565408 0.21529324]
Foot position too far (0.153m), limiting movement
DEBUG: current_step=0, time_step=21
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][21]
DEBUG: CoM reference: [0.17875064 0.12355914 0.4       ]
DEBUG: Actual CoM: [0.18075064 0.12555914 0.21472658]
Foot position too far (0.153m), limiting movement
DEBUG: current_step=0, time_step=22
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][22]
DEBUG: CoM reference: [0.17880421 0.12346273 0.4       ]
DEBUG: Actual CoM: [0.18080421 0.12546273 0.21414577]
Foot position too far (0.152m), limiting movement/Users/ernest/tsid_control/walking_simulation.py:565: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

DEBUG: current_step=0, time_step=23
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][23]
DEBUG: CoM reference: [0.17885659 0.12336505 0.4       ]
DEBUG: Actual CoM: [0.18085659 0.12536505 0.21355139]
Foot position too far (0.152m), limiting movement
DEBUG: current_step=0, time_step=24
DEBUG: len(dcm_traj)=3, len(footstep_traj)=2
DEBUG: Accessing dcm_traj[0][24]
DEBUG: CoM reference: [0.17890786 0.12326629 0.4       ]
DEBUG: Actual CoM: [0.18090786 0.12526629 0.21294399]
Foot position too far (0.152m), limiting movement
Simulation finished!
